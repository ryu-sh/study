## 용어 정리
MOM : 메세지 지향 미들웨어(Message Oriented Middleware) (비동기 메시지를 사용하는 응용 프로그램 간의 데이터 송수신)

SOA : Service-Oriented Architecture

AMQP : Advanced Message Queuing Protocol (ISO 응용 계층 프로토콜의 MOM 표준)

JMS : Java Message Service

## Message Queue란 ?
 - 메세지 큐는 프로세스 또는 프로그램 인스턴스가 데이터를 서로 교환할 때 사용하는 통신 방법, 더 큰 개념으로는 MOM을 구현한 시스템을 의미
 - MQ는 별도의 별도의 공정 작업을 연기할 수 있는 유연성을 제공하여 SOA, MSA의 개발에 도움을 줄 수 있다.
 - 서로 다른 프로세스나 프로그램 사이에 메시지를 교환할 때 AMQP를 이용
 - 시스템간의 연관이 많아지는 구조에서 (SOA, MSA 등) 서비스간 결합도를 낮추고, 비동기 요청, 성능, 안정성 등 여러가지 이점이 있어서 메시징 시스템을 사용하게 된다.

## 장점
 - 비동기 : 큐에 넣기 때문에 나중에 처리 가능
 - 비동조 : 애플리케이션과 분리 가능
 - 탄력성 : 일부가 실패시 전체에 영향 받지 않음
 - 과잉 : 실패할 경우 재실행 가능
 - 보증 : 작업이 처리된걸 확인 가능
 - 확장성 : 다수의 프로세스들이 큐에 메시지를 보낼 수 있음
 - 비스간의 결합성이 낮아지므로 각자의 비즈니스 로직에만 집중
 - 메시지 처리 방식은 Message Broker에 위임
 - 각 서비스는 Client를 통해 메시지를 보내고 받기만 하면 됨
 - 각 서비스는 비동기 방식으로 메시지를 보내기만 하면, Message Broker에서 순서 보장, 메시지 전송 보장등을 처리
 - 메시징 시스템이 잠깐 다운되어도 각 서비스에는 직접적인 영향을 미치지 않음

## 단점
 - 함수 호출, 공유메모리 사용 방식보다 메시징 시스템을 사용했을 때 호출 구간이 늘어나므로 네트워크 비용 발생
 - Message Broker 구축, 예를 들면 kafka 클러스터 구축에 필요한 금전, 인적자원에 대한 비용

## 사용 목적
 - 대용량 데이터를 처리하기 위한 배치작업, 채팅 서비스, 비동기 데이터 처리할때 사용
 - 프로세스 단위로 처리하는 웹요청이나 일반적인 프로그램을 만들어서 사용하는데, 사용자가 많아지거나 데이터가 많아지면 요청에 대한 응답을 기다리는 수가 증가하다가, 나중에는 대기 시간이 지연되어서, 서비스가 정상적으로 되지 못하는 상황이 오기 때문에, 기존에 분산되어 있던 데이터 처리를 한 곳에 집중하면서, 메시지 브로커를 두어서 필요한 프로그램에 작업을 분산시키는 방법을 하는것이 목적

## 어떨 때 사용할까?
 - Failover 서버간 데이터를 주고 받을 때 항상 시스템 장애를 염두해두어야 하는데, 서버에 문제나 네트워크의 문제에 대한 Failover 할 수 있다.
 - 서버 부하가 많은 작업 서버 부하가 많은 경우 원하는 만큼의 메세지를 소비하는 것이 가능하다.
 - 부하 분산에 용이하다. 한 큐에 여러 consumer가 존재할 수 있기 때문에 부하 분산이 가능하고, Scaling 대응에 적합하다.
 - 데이터 손실 방지 consumer가 broker에 처리 완료에 대한 응답을 주지 않은 경우(메세지 처리 중 문제가 발생하는 경우) 브로커는 큐에 메세지를 다시 넣어 처리할 수 있게 할 수 있음

## 주의할 점
 - MQ를 사용할 때 얻을 수 있는 잇점은 많지만 적재적소에 사용해야 한다. 요청 결과를 즉시 응답해야할 때에는 MQ는 어울리지 않는다. 주로 요청과는 별개로 처리할 수 있는 비동기 처리에 어울린다. 또한 서버에서 간단하게 처리할 수 있는 일을 MQ를 통해 전달하면 필요없는 오버헤드될 수도 있다.
