# 네트워크



### 웹 동작 방식

- 사용자가 브라우저에 URL을 입력
- 브라우저는 DNS를 통해 서버의 IP 주소를 찾음
- HTTP 프로토콜을 사용하여 HTTP 요청 메세지를 생성함
- TCP/IP 연결을 통해 HTTP요청이 서버로 전송됨
- 서버는 HTTP 프로토콜을 활용해 HTTP 응답 메세지를 생성함
- TCP/IP 연결을 통해 요청한 컴퓨터로 전송
- 도착한 HTTP 응답 메세지는 웹페이지 데이터로 변환되고, 웹 브라우저에 의해 출력되어 사용자가 볼 수 있게 됨



### OSI 7 Layer

![img](https://blog.kakaocdn.net/dn/bq5dyv/btqJls7HC1T/cTY7UKcQ4ZxmgxtenNf9MK/img.jpg)

- 7 계층(응용 계층): 사용자와 직접 상호작용하는 응용 프로그램들이 포함된 계층
- 6 계층(표현 계층): 데이터의 형식(Format)을 정의하는 계층
- 5 계층(세션 계층): 컴퓨터끼리 통신을 하기 위해 세션을 만드는 계층
- 4 계층(전송 계층): 최종 수신 프로세스로 데이터의 전송을 담당하는 계층
- 3 계층(네트워크 계층): 패킷을 목적지까지 가장 빠른 길로 전송하기 위한 계층
- 2 계층(데이터링크 계층): 데이터의 물리적인 전송과 에러 검출, 흐름 제어를 담당하는 계층
- 1 계층(물리 계층): 데이터를 전기 신호로 바꾸어주는 계층



### TCP/IP 4 Layer

- 4 계층(응용 계층)

  - OSI 7계층의 세션 계층, 표현 계층, 응용 계층에 해당한다.
  - TCP/UDP 기반의 응용 프로그램을 구현할 때 사용한다.
  - 프로토콜 – FTP, HTTP, SSH

- 3 계층(전송 계층)

  - OSI 7계층의 전송 계층에 해당한다.
  - 통신 노드 간의 연결을 제어하고, 신뢰성 있는 데이터 전송을 담당한다.

  - 프로토콜 – TCP, UDP

- 2 계층(인터넷 계층)

  - OSI 7계층의 네트워크 계층에 해당한다. 
  - 통신 노드 간의 IP패킷을 전송하는 기능과 라우팅 기능을 담당한다.
  - 프로토콜 – IP, ARP, RARP

- 1 계층(네트워크 액세스 계층)
  - OSI 7계층의 물리계층과 데이터 링크 계층에 해당한다.
  - 물리적인 주소로 MAC을 사용한다.
  - LAN, 패킷망, 등에 사용된다.



### TCP/UDP 차이

- TCP는 연결형 서비스로 3-way handshaking 과정을 통해 연결을 설정한다. 그렇기 때문에 높은 신뢰성을 보장하지만 속도가 비교적 느리다는 단점이 있다.
- UDP는 비연결형 서비스로 3-way handshaking을 사용하지 않기 때문에 신뢰성이 떨어지는 단점이 있다. 하지만 수신 여부를 확인하지 않기 때문에 속도가 빠르다.
- TCP는 신뢰성이 중요한 파일 교환과 같은 경우에 쓰이고 UDP는 실시간성이 중요한 스트리밍에 자주 사용된다.



### TCP-3-hands-shaking

![img](https://t1.daumcdn.net/cfile/tistory/225A964D52F1BB6917)

- 정확한 전송을 보장하기 위해 상대방 컴퓨터와 사전에 세션을 수립하는 과정
- STEP 1
  - A클라이언트는 B서버에 접속을 요청하는 SYN 패킷을 보낸다. 이때 A클라이언트는 SYN 을 보내고 SYN/ACK 응답을 기다리는SYN_SENT 상태가 되는 것이다.
- STEP 2
  - B서버는 SYN요청을 받고 A클라이언트에게 요청을 수락한다는 ACK 와 SYN flag 가 설정된 패킷을 발송하고 A가 다시 ACK으로 응답하기를 기다린다. 이때 B서버는 SYN_RECEIVED 상태가 된다.
- STEP 3
  - A클라이언트는 B서버에게 ACK을 보내고 이후로부터는 연결이 이루어지고 데이터가 오가게 되는것이다. 이때의 B서버 상태가 ESTABLISHED 이다.



### TCP-4-hands-shaking

![img](https://t1.daumcdn.net/cfile/tistory/2152353F52F1C02835)

- 세션을 종료하기 위해 수행되는 절차

- STEP 1
  - 클라이언트가 연결을 종료하겠다는 FIN플래그를 전송한다.

- STEP 2
  - 서버는 일단 확인메시지를 보내고 자신의 통신이 끝날때까지 기다리는데 이 상태가 TIME_WAIT 상태다.

- STEP 3
  - 서버가 통신이 끝났으면 연결이 종료되었다고 클라이언트에게 FIN플래그를 전송한다.

- STEP 4
  - 클라이언트는 확인했다는 메시지를 보낸다.



### TCP Flag 종류

- SYN( synchronization ) : 연결 요청 플래그
  - 통신 시작 시 세션을 연결하기 위한 플래그

- ACK( Acknowledgement ) : 응답 플래그
  - 송신측 으로부터 패킷을 잘 받았다는 걸 알려주기 위한 플래그
- FIN( Finish ) : 연결 종료 플래그
  - 더 이상 전송할 데이터가 없고 세션 연결을 종료시키겠다는 플래그

- RST( Reset ) : 연결 재설정 플래그
  - 비정상적인 세션을 끊기위해 연결을 재설정 하는 과정

- PSH( Push ) : 넣기 플래그
  - 버퍼가 채워지기를 기다리지 않고 받는 즉시 전달한다.
  - 버퍼링 없이 7 Layer Application Layer의 응용프로그램에게 바로 전달하는 플래그.

- URG( Urgent ) : 긴급 데이터 플래그
  - 긴급한 데이터의 우선순위를 다른 데이터의 우선순위를 높여 긴급하게 전달하는 플래그



### TCP의 Nagle 알고리즘

- Nagle알고리즘은 네트워크 패킷을 줄이기 위해 개발된 알고리즘이다. 
- ACK를 받을 때 까지 출력버퍼에 데이터를 저장하였다가 한번에 보내는 방식이다
- 장점 : 생산하는 패킷량이 줄어 네트워크 사용 효율이 높아진다.
- 단점 : ACK를 기다리기 때문에 전송이 지연되어 속도가 저하된다.



###  HTTP 프로토콜

- HTTP이란 서버/클라이언트 모델을 따라 데이터를 주고 받기 위한 프로토콜
- HTTP는 애플리케이션 레벨의 프로토콜로 TCP/IP 위에서 작동
- HTTP는 상태를 가지고 있지 않는 Stateless 프로토콜
- Method, Path, Version, Headers, Body 등으로 구성



### HTTPS

- HTTPS는 자신의 공개키를 갖는 인증서를 발급하여 보내는 메세지를 공개키로 암호화하도록 한다.
- 공개키로 암호화된 메세지는 개인키를 가지고 있어야만 복호화가 가능하기 때문에, 기업을 제외한 누구도 원본 데이터를 얻을 수 없다.



### DNS의 Round Robin

- 별도의 소프트웨어 나 하드웨어 로드밸런싱 장비를 이용하지 않고 DNS를 이용하여 도메인 정보를 조회하는 시점에서 다른 IP정보를 통해 트래픽을 분산하는 기법
- DNS 를 이용한 라운드로빈 로드 밸런싱은 로드밸런스 전용의 소프트웨어나 하드웨어와 달리 Health check 에 대안 기능이 없다.



### Routing Table

-  패킷이 목적지, 목적지까지의 거리와 가는 방법 등을 명시하고 있는 테이블



### HTTP 1.1과 2.0의 차이점

- HTTP 1.1
  - 연결당 하나의 요청과 응답을 처리하기 때문에 동시 전송 문제와 다수의 리소스를 처리하기에 속도와 성능 이슈가 존재
  - http/1.1의 헤더에는 많은 메타 정보들이 저장되어 있음.
- HTTP 2.0
  - 한 커넥션에 여러개의 메세지를 동시에 주고 받을 수 있음



### REST API

- 자원에 대해 CRUD(Create, Read, Update, Delete) 를 수행하기 위해 URI(Resource)로 요청을 보내는 것



### ASCII코드

- 128개의 문자조합을 제공하는 7비트 부호

- 아스키코드만으로는 각 나라별 언어를 표현할 수 없다. 이를 해결한 코드가 유니코드



### 유니코드(Unicode)

- 국제적으로 전세계 언어를 모두 표시할 수 있는 표준코드
- 모든 문자에 대해서 Unique한 넘버를 부여



### UTF-8

- 유니코드를 인코딩(encoding)하는 방식
- 가변 길이
- 한 글자가 1~4바이트 중 하나로 인코딩될 수 있다.
- 영문/숫자/기호는 1바이트로, 한글/한자는 3바이트로 표현



### URI과 URL의 차이점

- URI
  - 인터넷에 있는 자원을 나타내는 유일한 주소

- URL
  - 자원의 위치
- URI의 하위개념에 URL, URN 이 포함되어 있다.
- http://test.com/test.pdf?docid=111, http://test.com/test.pdf?docid=112는 같은 URL을 가지고 다른 URI를 가짐



### URL Encode

- URL은 아스키코드로 이뤄져야하기 때문에 그 외의 문자는 “%”와 16진수 문자를 조합해 인코딩 한다



### Cookie와 Session

- 쿠키와 세션은 비슷한 역할을 하며, 동작원리도 비슷하다. 그 이유는 세션도 결국 쿠키를 사용하기 때문입니다.
- 가장 큰 차이점은 사용자의 정보가 저장되는 위치이다